% THIS TEMPLATE IS A WORK IN PROGRESS
% Adapted from an original template by faculty at Reykjavik University, Iceland

\documentclass{scrartcl}
\input{File_Setup.tex}

\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{comment}



\begin{document}
%Title of the report, name of coworkers and dates (of experiment and of report).
\begin{titlepage}
	\centering
	\vspace{2cm}
	%%%% COMMENT OUT irrelevant lines among the 3 below
	{\scshape\LARGE Санкт-Петербугрский Политехнический университет \par}  %if you're a CS major
	{\scshape\LARGE  \par}                %if you're a CS & DS major
	{\scshape\LARGE Физико-Механический институт \par}      %if you're a DS major
	\vspace{1cm}
	{\scshape\Large Направление подготовки\par}
	{\scshape\Large “Прикладная математика и информатика”\par}
	%{\large \today\par}
	\vfill
	
	%%%% PROJECT TITLE
	{\huge\bfseries Отчет по курсовой работе\par}
	{\huge\bfseries Сравнение решений ОДУ 2 порядка методом Рунге-Кутты 4 порядка и методом конечных разностей 2 порядка\par}
	\vfill
	
	\begin{flushleft}
     	{\scshape\Large Выполнил студент группы 5030102/00002: \begin{flushright} Хламкин Е.В. \end{flushright} \par}
    	{\scshape\Large Преподаватель: \begin{flushright} Добрецова С.Б. \end{flushright} \par}
    \end{flushleft}
	

	\vfill
	Санкт-Петербург\par
	%%%% SUPERVISOR(S)
	2022


	\vfill
% Bottom of the page
\end{titlepage}


\newpage

\doublespacing

\section{Задание}

Дано ОДУ 2-ого порядка $y'' + \frac{-1}{x^2(x+1)}y' + \frac{-2}{x^2(x+1)}y = \frac{1}{x^4(x+1)}$ и отрезок $[a;b]$: $a = 0.2, b = 1$. Найти решение задачи Коши для этого уравнения методом Рунге-Кутты 4 порядка. Найти решение краевой задачи для этого уравнения методом конечных разностей 2 порядка. Провести сравнение результатов по графикам ошибок на отрезке для двух значений шага. Исследовать зависимость нормы погрешности и координаты максимального значения погрешности на отрезке от величины шага.

\section{Постановка задачи} 

Дано ОДУ 2-ого порядка: $y'' + p(x)y' + q(x)y = f(x)$ \par
$p(x) = \frac{-1}{x^2(x+1)}$\par
$q(x) = \frac{-2}{x^2(x+1)}$\par
$f(x) = \frac{1}{x^4(x+1)}$\par
Отрезок $[a;b]$: $a = 0.2, b = 1$ \par
Точное решение: $y=1+\frac{1}{x}$\par
n + 1 - число точек\par
h - шаг, $h=\frac{b-a}{n}$\par
Граничные условия задачи Коши: $y(x_0) = 6, y'(x_0) = -25$ \par
Граничные условия краевой задачи: $y(x_0) = 6, y(x_n) = 2$ \par
Задача: найти решения задачи Коши и краевой задачи для данного уравнения на данном отрезке.
\begin{comment}
Задача: найти $y_i^1 = y(x_i^1)$ - компоненты каркаса для численного решения задачи Коши и $y_i^2 = y(x_i^2)$ - компоненты каркаса для численного решения краевой задачи.
\end{comment}


\newpage


\section{Предварительный анализ задачи}
Решением поставленных задач будем считать $y_i^1 = y(x_i^1)$ - компоненты каркаса для численного решения задачи Коши и $y_i^2 = y(x_i^2)$ - компоненты каркаса для численного решения краевой задачи. Непрерывную задачу сведем к дискретной. Разобьем отрезок $[a;b]$ n+1 точкой, в каждой из которых будем искать значение функции $y_i$. Для задачи Коши граничных условий достаточно, чтобы начать (используя разложение функции в ряд Тейлора до 4-й степени) последовательно находить значения функции в точках $x_i$, $i=0..n$. Для краевой задачи аппроксимируем $y''$ и $y'$, и подставляем полученные аппроксимации в исходное ОДУ, получая тем самым СЛАУ из n + 1 уравнения, где неизвестные - значения $y_i^2, i = 0..n$.




\section{Алгоритмы}

Для краевой задачи:

а) Условия применимости: Потребуем для функций $p(x), q(x), f(x)$ непрерывности хотя бы из класса $C^{(0)}$. Гарантировать же применимость метода прогонки будет выполнение условия диагонального преобладания для матрицы коэффициентов: $|d_i| \geq |c_i| + |e_i|$, где $d_i, c_i, e_i$ - диагональные элементы, поддиагональные элементы и наддиагональные элементы соответственно. В частности, для метода конечных разностей и приведенного(!) ОДУ это условие сводится к следующему: 

\begin{equation*}
 \begin{cases}
   $h \leq \frac{2}{|p(x)|}$\\
   $q(x) \leq 0$
 \end{cases}
\end{equation*}

Первое условие для данной задачи приобретает вид: $h \leq 0.16$ (в дальнейшем это соответствует экспериментам)\par
Второе условие выполняется для всех $"x"$ на отрезке.

б) Этапы решения: Подставить аппроксимированные значения производных в исходное ОДУ, получив тем самым СЛАУ, первая и последняя строки которой определяются граничными условиями 1 типа. Решить систему методом прогонки. \par

\newpage


в) Алгоритм: Формулы аппроксимации:
\begin{center}
  $y'(x_i) = \frac{y(x_{i+1}) - y(x_{i-1})}{2h} + O(h^2)$, $y''(x_i) = \frac{y(x_{i+1}) - 2y(x_i) + y(x_{i-1})}{h^2} + O(h^2)$ \\
\end{center}
\hspace{7mm} Полученное дискретное ОДУ:
\begin{center}
  $\frac{y_{i+1} - 2y_i + y_{i-1}}{h^2} + \frac{y_{i+1} - y_{i-1}}{2h}p_i + q_iy_i = f_i$ \\
\end{center}
\hspace{7mm} Приведем подобные:
\begin{center}
  $(1 - \frac{h}{2}p_i)y_{i-1} - (2 - h^2q_i)y_i + (1 + \frac{h}{2}p_i)y_{i+1} = h^2f_i$ \\
\end{center}
\hspace{7mm} Это уравнение заключает в себе строки СЛАУ для $i = 1..n-1$. Первая строка: $y_0 = A$, последняя строка: $y_n = B$. Решаем СЛАУ методом прогонки, т.е делаем прямой и обратный ход.\par
\hspace{3mm} Прямой ход: в i-й строке выражаем $y_i$ и для $i = 1..n-1$ последовательно подставляем выраженные значения $y_{i-1}$.\par
\hspace{3mm} Обратный ход: в i-ю строку подставляем значения $y_{i+1}$ для $i = n-1..1$, получая тем самым искомые значения $y_i, i = 0..n$.\par
г) Теоретические расчёты: Метод конечных разностей изначально предполагается первого порядка. Однако порядок метода в данном случае определяется степенью аппроксимации производных при граничных условиях. Коль скоро эти условия 1-ого типа, говорить об аппроксимации не имеет смысла - они выполняются точно и порядок схемы полностью определяется порядком аппроксимации ДУ, и метод приобретает второй порядок, что в теории говорит о том, что при уменьшении величины шага на один порядок, точность должна увеличиваться на два.\par

Для задачи Коши:

а) Условия применимости: По теореме о существовании и единственности задачи Коши, если в некоторой окрестности точки $(x_0,y_0)$ $f(x)$ определена, непрерывна и имеет ограниченную по модулю производную, то существует окрестность $(x_0,y_0)$, в которой решение будет, и притом единственное. \par


б) Этапы решения: идею методов Рунге-Кутты для ОДУ 1 порядка экстраполируем на ОДУ 2 порядка, произведя замену $z = y'$. Получим систему из двух уравнений. На каждом шаге будем вычислять 4 поправки, которые в своей линейной комбинации и будут составлять значение $y_i$ на каждом шаге.\par
в) Алгоритм: Введем обозначения: $z = y'$, $z' = y'' = -p(x)y' - q(x)y + f(x) = F(x, y, z)$. Для каждого $x_i$ будем вычислять следующие выражения:\\
$       \sigma_0 = F(x_i, y_i, z_i);\\
        \gamma_0 = z_i;\\ \\
        \sigma_1 = F(x_i + \frac{h}{2}, y_i + \gamma_0\frac{h}{2}, z_i + \sigma_0\frac{h}{2});\\
        \gamma_1 = z_0 + \sigma_0\frac{h}{2};\\ \\
        \sigma_2 = F(x_i + h/2, y_i + \gamma_1\frac{h}{2}, z_i + \sigma_1\frac{h}{2});\\
        \gamma_2 = z_i + \sigma_1\frac{h}{2};\\ \\
        \sigma_3 = F(x_i + h, y_i + h\gamma_2, z_i + h\sigma_2);\\
        \gamma_3 = z_i + h\sigma_2;$\par\par
Причем $y_0$ и $z_0$ для $x_0$ задаются начальными условиями, а для последующих $x_i, i = 1..n$, $y_{i+1}$ и $z_{i+1}$ вычисляются по формулам со значениями $\sigma$ и $\gamma$ предыдущего шага: 
\begin{center}
     $  z_{i+1} = z_i + \frac{h}{6}(\sigma_0 + 2\sigma_1 + 2\sigma_2 + \sigma_3);\\
        y_{i+1} = y_i + \frac{h}{6}(\gamma_0 + 2\gamma_1 + 2\gamma_2 + \gamma_3);$
\end{center}


г) Теоретические расчёты: Метод Рунге-Кутты локально имеет 5 порядок, но из-за накопления ошибки порядок снижается до 4-ого. Это означает, что в теории при уменьшении величины шага на один порядок должна прослеживаться тенденция увеличения точности на 4 порядка. При этом надо рассчитывать на то, что для точек, лежащих ближе к правому концу исходного отрезка, четвертый порядок наблюдать не придется.


\section{Контрольные тесты}
ОДУ 2-ого порядка: $y'' + p(x)y' + q(x)y = f(x), p(x) = \frac{-1}{x^2(x+1)}, q(x) = \frac{-2}{x^2(x+1)}, f(x) = \frac{1}{x^4(x+1)}$\par
а) Построим графики решений краевой задачи и задачи Коши для двух шагов: $h = 0.04$ и $h = 0.08$. Исходный отрезок: $[a;b], a = 0.2, b = 1$. \par
б) Измерим погрешность в зависимости от шага. Будем брать шаг $h = \frac{b-a}{2^{i+1}}, i = 0..13$ (14 значений) и получать бесконечную норму погрешности на отрезке $[a;b], a = 0.2, b = 1$. Найдем также координату максимальной погрешности на отрезке.



\section{Численный анализ}
Построим графики полученных в зависимости от шага решений, а также ошибок на отрезке $[a;b]$.

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.43]{Figure_1.png}
	\end{center}
\end{figure}

Заметно, что увеличение числа точек положительно сказывается на сходимости обеих задач. Также оба графика явно демонстрируют следующее: в задаче Коши ошибка действительно накапливается и достигает своего максимального значения на правом конце отрезка. В случае же краевой задачи с граничными условиями 1-ого типа ошибки на концах отрезка принимают нулевые значения, в то время как максимальная ошибка находится вблизи левого конца отрезка.


\newpage
Теперь посмотрим, как ведет себя погрешность численного решения при более существенном уменьшении шага, а также пронаблюдаем за координатой максимальной погрешности на отрезке.

\begin{figure}[H]
	\begin{flushleft}
		\includegraphics[scale=0.43]{Figure_3.png}
	\end{flushleft}
\end{figure}

О точности можно сказать следующее: ее порядок в методе Рунге-Кутты не совпадает с теоретическим четвертым, хотя к тому и можно наблюдать некоторое стремление. Такой диссонанс можно объяснить, во-первых, тем, что накопление ошибки может быть достаточно существенным, а, во-вторых, тем, что часть точности теряется при сведении задачи о решении ОДУ 2-ого порядка к решению ОДУ 1-ого порядка. Характер сходимости метода конечных разностей более линейный, и отставание от теоретической точности для каждого из шагов составляет всегда 1 порядок, что объяснимо тем, что есть некоторая константа $C$, получаемая как $O(h^2) = Ch^2$. Заметим также, что погрешности методов совпадают для шага $10^{-2}$ Это объяснимо тем, что для больших h метод конечных разностей будет давать лучшую сходимость. Тем не менее, эта сходимость гасится порядком метода Рунге-Кутты, который для более мелкого разбиения стремится к 4-му порядку. Что же касается координаты максимальной погрешности в зависимости от шага, для метода Рунге-Кутты результат ожидаем: это значение есть правый конец отрезка, то есть $x = 1$. Для метода конечных разностей координата максимальной погрешности сходится к одному конкретному значению на отрезке: $x = 0.3681$. 


\newpage

\section{Выводы}

\begin{comment}
Задача Коши и краевая задача - два частых явления, возникаюзих как результат обработки некоторой физической или математической модели. В основе каждой из них лежит идея решения ОДУ. Погрешности же решений в случае вышеупомянутых методов различаются, что является поводом к тому, чтобы понять, к какой лучше задаче сводить модель. К примеру, если отрезок, на котором необходимо вычислить решение ОДУ, велик, и не требуется точность более чем $10^{-3}$, то ресурсов на решение краевой задачи потребуется меньше, чем на решение задачи Коши при прочих равных. Тем не менее, если же требуется более высокая точность, то в рекомендацию всупает уже метод Рунге-Кутты 4 порядка и соответствующая ему задача Коши.
\end{comment}


Проводя сравнение погрешностей и координат максимальных ошибок для метода Рунге-Кутты и метода конечных разностей, можно говорить о следующем: для больших шагов (более чем $10^{-3}$) метод конечных разностей дает более точный результат. Тем не менее, для шагов, меньших чем $10^{-3}$, метод Рунге-Кутты явно лучше. Полезным может оказаться тот факт, что координаты максимальной ошибки у методов различны, что дает некоторую свободу при выборе метода.
\end{document}
